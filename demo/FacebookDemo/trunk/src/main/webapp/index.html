<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml">
<head>
  <title>Facebook Connect Demo 1</title>
  <style type="text/css">
    @import "js/dojo-1.1.1/release/dojo/dojo/resources/dojo.css";
    @import "js/dojo-1.1.1/release/dojo/dojox/grid/_grid/tundraGrid.css";
    @import "js/dojo-1.1.1/release/dojo/dijit/themes/tundra/tundra.css";
    
    html, body, .mainDiv {
      width: 100%;
      height: 100%;
      padding: 0;
      border: 0;
      margin: 0;
    }
    
    .userbox {
      vertical-align: middle;
    }
    
    form {
      padding: 3px;
    }

    form .formlabel {
      font-weight: bold;
    }
  </style>

  <script src="http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php" type="text/javascript"></script>


</head>

<body class="tundra">



  <div id="splashscreen" style="position: absolute; height: 100%; width: 100%; z-index: 1000; vertical-align: middle; background-color: white; opacity: 1.0">
    <div style="position: absolute; top: 45%; width: 100%;">
      <div style="width: 30em; text-align: center; margin: auto;">
        <p><img src="image/ajax-loader.gif"></img><br/><br/>Loading</p>
      </div>
    </div>
  </div>

  

  <div class="mainDiv" dojoType="dijit.layout.BorderContainer" design="headline" liveSplitters="false">
    <div dojoType="dijit.layout.ContentPane" region="top" splitter="false" style="height: 60px;">
      <div id="userbox" class="userbox">
      </div>
    </div>
    
    <div dojoType="dijit.layout.ContentPane" region="center" splitter="false">
      <div dojoType="dijit.layout.TabContainer">
        <div dojoType="dijit.layout.ContentPane" title="Your movies">
          <div dojoType="dijit.layout.BorderContainer" liveSplitters="true">
            <div dojoType="dijit.layout.ContentPane" region="left" splitter="true" style="width: 250px;">
              <div id="lstYourMovies" jsId="lstYourMovies" dojoType="org.ppwcode.dojo.dijit.form.PpwMasterView" gridStructure="yourmovielistgridlayout" gridModel="yourmovielistgridmodel">
              </div>
            </div>
            <div dojoType="dijit.layout.ContentPane" region="center" splitter="true">
              <form id="frmYourMovie"
                    jsId="frmYourMovie"
                    dojoType="org.ppwcode.dojo.dijit.form.PpwCrudForm"
                    constructorFunction="Movie">
                <input type="hidden"
                       id="yourMovieIdHiddenBox"
                       jsId="yourMovieIdHiddenBox"
                       dojoType="dijit.form.TextBox"
                />
                <input type="hidden"
                       id="yourMoviePersistenceVersionHiddenBox"
                       jsId="yourMoviePersistenceVersionHiddenBox"
                       dojoType="dijit.form.TextBox"
                />
                <input type="hidden"
                       id="yourFacebookUserIdHiddenBox"
                       jsId="yourFacebookUserIdHiddenBox"
                       dojoType="dijit.form.TextBox"
                />
                <label class="formlabel">
                  Title
                </label>
                <br/>
                <input type="text"
                       id="yourMovieTitle"
                       name="yourMovieTitle"
                       class="formtextbox"
                       dojoType="dijit.form.ValidationTextBox"
                       required="true"
                       trim="true"
                />
              </form>
            </div>
          </div>
        </div>
        <div dojoType="dijit.layout.ContentPane" title="Your friends' movies">
          <div dojoType="dijit.layout.BorderContainer" design="sidebar" livesplitters="true">
            <div dojoType="dijit.layout.ContentPane" region="left" splitter="true" style="width: 350px;">
              <div id="fbFriendsGrid" jsId="fbFriendsGrid" dojoType="dojox.Grid" model="fbfriendsgridmodel" structure="fbfriendsgridlayout">
                <script type="dojo/method" event="onRowClick" args="e">
                  var user = fbfriendsgridmodel.getRow(e.rowIndex);
                  fbFriendForm.displayItem(user);
                  //console.dir(user);
                  JpaMovieDaoWrapper.findByFacebookUser(user.uid,
                    {
                      callback: function(response) {
                        fbfriendsmoviesgridmodel.setData(response);
                      },
                      errorHandler: function(errorString, ex) {
                        console.error(errorString);
                      }
                    }
                  );
                </script>
                <script type="dojo/method" event="onHeaderClick">
                  fbFriendForm.reset();
                </script>
              </div>
            </div>
            <div dojoType="dijit.layout.ContentPane" region="center" splitter="true">
              <div dojoType="dijit.layout.BorderContainer" design="headline" liveSplitters="true">
                <div dojoType="dijit.layout.ContentPane" region="top" splitter="true" style="height: 160px;">
                  <form id="fbFriendForm" jsId="fbFriendForm" dojoType="org.ppwcode.dojo.dijit.form.PpwObjectForm">
                    <table>
                      <tbody>
                        <tr>
                          <td style="width: 100px; padding: 2px; text-align: center; vertical-align: top;">
                           <span id="FbFriendPicture" dojoType="org.ppwcode.dojo.dijit.form.PpwImageBox"></span>
                          </td>
                          <td style="vertical-align: top;">
                            <div>
                              <label>First Name</label><br/>
                              <div style="height: 4ex;">
                                <input id="FbFriendFirstName" dojoType="dijit.form.TextBox"></input>
                              </div>
                            </div>
                            <div>  
                              <label>Last Name</label><br/>
                              <input id="FbFriendLastName" dojoType="dijit.form.TextBox"></input>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </form>
                </div>
                <div dojoType="dijit.layout.ContentPane" region="center" splitter="true">
                  <div id="lstFriendsMoviesGrid" jsId="lstFriendsMoviesGrid" dojoType="dojox.Grid" model="fbfriendsmoviesgridmodel" structure="fbfriendsmoviesgridlayout">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
    
  <script type='text/javascript' src='dwr/interface/JpaAtomicStatelessCrudDaoWrapper.js'></script>
  <script type='text/javascript' src='dwr/interface/JpaMovieDaoWrapper.js'></script>
  <script type='text/javascript' src='dwr/engine.js'></script>

  <script type="text/javascript">
    FB.init("c77ef4b86b5c5442c67898ba963d8735", "xd_receiver.htm");
  </script>

  <script type="text/javascript"
          src="js/dojo-1.1.1/release/dojo/dojo/dojo.js" djConfig="modulePaths: {org: '../org'}, isDebug: false">
  </script>

  <script type="text/javascript" src="js/dojo-1.1.1/release/dojo/dojo/ppwfacebookdemo.js"></script>

</body>
</html>
